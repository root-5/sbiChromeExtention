/**
 * SBI証券拡張機能のコンテンツスクリプト用CSS
 * ページに追加される拡張機能のUIスタイル
 */

/* 不要な要素を非表示にする */
body > div:nth-child(1) > header > nav > section > div.slc-header-nav-menu > div.slc-header-nav-menu-items > div.slc-header-nav-upper-menu,
body > div:nth-child(1) > nav.slc-global-nav,
#TIMEAREA01,
body > table,
body > div.middleArea2,
footer,
#karte-c {
  display: none;
}

/* ヘッダーの「サービス」があると表示崩れを起こす */
body
  > div:nth-child(1)
  > header
  > nav
  > section
  > div.slc-header-nav-menu
  > div.slc-header-nav-menu-items
  > div.slc-header-nav-lower-menu
  > ul
  > li.slc-nav-item.slc-nav-accordion-item.slc-dropdown-menu {
  display: none;
}

/* ヘッダーの高さを調整し、ホバー時だけ表示させるようにする */
body > div:nth-child(1) > header.slc-header > nav.slc-header-nav {
  height: 4.0625em;
}
body > div:nth-child(1) {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  z-index: 10000;

  > * {
    opacity: 0;
  }

  &:hover {
    height: auto;

    > * {
      opacity: 1;
    }
  }
}

/* 拡張機能パネルの共通スタイル */
#jpyAccountPanel {
  position: relative;
  width: 90%;
  max-width: 75em;
  margin: 1.25em auto;
  padding: 2em;
  background: #ffffff;
  color: #333333;
  text-align: left;
  font-family: Helvetica;
  font-weight: 400;
  font-size: 0.8125em; /* 基本フォントサイズ、em の基準 */
  vertical-align: middle;
  border: 0.125em solid #0066cc;
  border-radius: 0.75em;
  box-shadow: 0 0.25em 1.25em rgba(0, 0, 0, 0.15);
  overflow: hidden;

  @media (max-width: 60.5em) {
    font-size: 0.9em;
    margin: 1.25em;
  }
  @media (max-width: 30em) {
    font-size: 0.8em;
  }

  h1 {
    font-size: 1.2em;
    font-weight: bold;
  }
  h2 {
    margin-bottom: 0.625em;
    color: #0066cc;
    font-size: 1.2em;
    font-weight: 600;
  }

  .flex {
    display: flex;
    flex-wrap: nowrap;
    justify-content: space-between;
    gap: 2em;
  }

  table {
    border-collapse: collapse;
    background: #ffffff;
    box-shadow: 0 0.125em 0.5em rgba(0, 0, 0, 0.1);
    vertical-align: middle;

    td,
    th {
      padding: 0.8em 0.9em;
    }

    @media (max-width: 48em) {
      th,
      td {
        padding: 0.7em 0.8em;
      }
    }

    @media (max-width: 30em) {
      th,
      td {
        padding: 0.6em 0.7em;
      }
    }

    .positive {
      color: #28a745;
    }
    .negative {
      color: #dc3545;
    }

    thead {
      color: white;
      background: linear-gradient(135deg, #0066cc, #004499);
      border-bottom: 0.125em solid #003366;
      white-space: nowrap;
    }

    tbody tr {
      border-bottom: 0.0625em solid #e9ecef;
      transition: background-color 0.2s ease;

      &:hover {
        background: #f8f9fa;
      }
    }

    tfoot {
      background: #f8f9fa;
      border-top: 0.125em solid #0066cc;

      td {
        font-weight: bold;
        padding: 0.75em 0.875em;
        color: #0066cc;
      }
    }
  }
}

/* 時刻表示エリアのスタイル */
#jpyAccountClock {
  display: flex;
  align-items: center;
  justify-content: end;
  gap: 0.75em;

  .clockValue {
    color: #0066cc;
    padding-top: 0.1875em;
  }
}

/* 円グラフコンテナ */
#jpyAccountPieChartContainer {
  padding: 1.25em;
  width: 35%;
  max-width: 23.4375em;
  aspect-ratio: 1;

  @media (max-width: 30em) {
    padding: 0.9375em;
  }
}

/* ポートフォリオテーブルのスタイル */
#jpyAccountSummaryContainer,
#jpyAccountTableContainer {
  padding-top: 1.25em;

  @media (max-width: 30em) {
    padding: 0.625em;
    overflow-x: auto;
  }

  table {
    width: 100%;

    td {
      &.code {
        color: #0066cc;
        text-align: center;
      }

      &.quantity,
      &.buyPrice,
      &.currentPrice,
      &.dayChange,
      &.profitAndLoss,
      &.marketCap,
      &.profit,
      &.amount {
        text-align: right;
      }

      &.dayChange,
      &.profitAndLoss {
        font-weight: 600;
      }

      .percent {
        font-size: 0.7em;
      }
    }
  }
}

#jpyAccountSummaryContainer {
  display: flex;
  gap: 2em;
  /* justify-content: space-between; */

  /* div {
    width: calc(50% - 2em);
  } */

  table {
    width: fit-content;
  }
}

#calcToolsContainer {
  margin-top: 1.875em;

  /* レバレッジ簡易計算のスタイル */
  #leverageCalculator {
    margin-top: 1em;
    padding: 0.875em 1em;
    border: 0.0625em dashed #0066cc;
    border-radius: 0.625em;
    background: #f5f9ff;
    display: flex;
    flex-direction: column;
    gap: 0.75em;

    h3 {
      margin: 0;
      font-size: 1em;
      color: #004499;
    }

    .leverageCalcControls {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.625em 0.875em;

      @media (max-width: 48em) {
        grid-template-columns: 1fr;
      }
    }

    .leverageCalcControl {
      display: flex;
      flex-direction: column;
      gap: 0.375em;
      padding: 0.625em 0.75em;
      background: #ffffff;
      border: 0.0625em solid #d6e6f7;
      border-radius: 0.5em;

      .question {
        font-weight: 600;
        color: #003366;
        line-height: 1.4;
      }

      select {
        padding: 0.5em;
        border: 0.0625em solid #b6c6d6;
        border-radius: 0.375em;
        background: #f8fbff;
        font-size: 0.95em;
        color: #333333;
      }
    }

    .leverageCalcResult {
      display: grid;
      grid-template-columns: auto 1fr auto;
      align-items: baseline;
      gap: 0.5em;
      padding: 0.75em 0.875em;
      background: linear-gradient(90deg, #e8f2ff, #f9fcff);
      border: 0.0625em solid #c5daf4;
      border-radius: 0.5em;

      .resultLabel {
        font-weight: 700;
        color: #004499;
      }

      .resultValue {
        font-size: 1.4em;
        font-weight: 700;
        color: #0066cc;
        text-align: right;
      }

      .resultUnit {
        font-weight: 600;
        color: #004499;
      }

      .resultDetail {
        grid-column: 1 / -1;
        font-size: 0.9em;
        color: #555555;
        line-height: 1.4;
      }
    }
  }
}

/* 取引履歴テーブルコンテナ（当日約定含む） */
#jpyAccountTradingLogContainer {
  width: calc(43% - 1em);
  margin-top: 1.875em;

  /* テーブルをラップする要素にスクロールを適用 */
  .table-wrapper {
    width: fit-content;
    max-height: 25em;
    overflow-y: auto;
    box-shadow: 0 0.125em 0.5em rgba(0, 0, 0, 0.1);

    &::-webkit-scrollbar {
      display: none;
    }
  }

  table {
    width: auto;

    thead {
      position: sticky;
      top: 0;
      z-index: 10;
      border-spacing: inherit;
    }

    tbody {
      td {
        &.code {
          color: #0066cc;
          text-align: center;
        }

        &.quantity,
        &.price {
          text-align: right;
        }

        &.tradeType {
          text-align: center;
          font-weight: 600;
        }
      }
    }
  }
}

/* 株価変化率と売買数テーブルコンテナ */
#priceChangeTableContainer {
  width: calc(57% - 1em);
  margin-top: 1.875em;

  /* テーブルをラップする要素にスクロールを適用 */
  .table-wrapper {
    width: 100%;
    overflow-x: auto;
    box-shadow: 0 0.125em 0.5em rgba(0, 0, 0, 0.1);

    &::-webkit-scrollbar {
      display: none;
    }
  }

  table {
    width: 100%;
    min-width: 87.5em;

    thead {
      position: sticky;
      top: 0;
      z-index: 10;

      th {
        font-size: 0.95em;
        white-space: nowrap;
      }

      th.code-header {
        position: sticky;
        left: 0;
        z-index: 10;
        background: #0066cc;
      }

      th.name-header {
        position: sticky;
        left: 4.8em;
        z-index: 10;
        background: #0066cc;
      }

      .date-header {
        font-size: 0.85em;
        padding-top: 0.9em;
        padding-bottom: 0.6em;
      }

      tr:nth-child(2) th {
        font-size: 0.85em;
        padding-top: 0.5em;
        padding-bottom: 0.5em;
      }
    }

    tbody {
      td {
        &.code {
          color: #0066cc;
          text-align: center;
          background: #ffffff;
          position: sticky;
          left: 0;
          z-index: 5;
        }

        &.name {
          background: #ffffff;
          position: sticky;
          left: 4.55em;
          z-index: 5;
          white-space: nowrap;
        }

        &.changeRate {
          text-align: right;

          &.positive,
          &.negative {
            font-weight: 600;
          }
        }
        &.quantity {
          text-align: right;
        }
      }
    }
  }
}
