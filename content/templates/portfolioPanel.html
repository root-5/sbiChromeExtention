<!-- ポートフォリオパネルのテンプレート -->
<div id="jpyAccountPanel">
    <!-- 時刻表示エリア -->
    <div class="flex">
        <h1>日本円建て口座ポートフォリオ</h1>
        <div id="jpyAccountClock">
            <span class="clockLabel">現在時刻:</span>
            <span class="clockValue" data-bind="currentTime">--:--:--</span>
            <span class="clockSeparator">|</span>
            <span class="clockLabel">最終更新:</span>
            <span class="clockValue" data-bind="lastUpdateTime">--:--:--</span>
        </div>
    </div>
    <div class="flex">
        <!-- 円グラフコンテナ -->
        <div id="jpyAccountPieChartContainer">
            <canvas id="jpyAccountPieChartCanvas"></canvas>
        </div>
        <div>
            <!-- ポートフォリオサマリーコンテナ -->
            <div id="jpyAccountSummaryContainer">
                <div>
                    <h2>サマリー</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>純資産</th>
                                <th>総資産</th>
                                <th>レバレッジ</th>
                                <th>買付余力</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="amount" data-bind="netTotalMarketCap">-</td>
                                <td class="amount" data-bind="totalMarketCap">-</td>
                                <td class="amount" data-bind="leverage">-</td>
                                <td class="amount" data-bind="buyingPower">-</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div>
                    <h2>レバレッジ</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>基準</th>
                                <th>差額</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr data-bind="leverageManagementRow">
                                <td data-bind="label"></td>
                                <td class="amount" data-bind="diff"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- ポートフォリオテーブルコンテナ -->
            <div id="jpyAccountTableContainer">
                <h2>ポートフォリオ</h2>
                <table>
                    <!-- テーブルヘッダー -->
                    <thead>
                        <tr>
                            <th>コード</th>
                            <th>銘柄名</th>
                            <th>株数</th>
                            <th>取得価格</th>
                            <th>現在価格</th>
                            <th>前日比</th>
                            <th>損益</th>
                            <th>時価総額</th>
                        </tr>
                    </thead>
                    <!-- テーブルボディ（データバインディング用） -->
                    <tbody>
                        <tr data-bind="jpyAccountTableRow" class="totalRow">
                            <td data-bind="code" class="code"></td>
                            <td data-bind="name" class="name"></td>
                            <td data-bind="quantity" class="quantity"></td>
                            <td data-bind="buyPrice" class="buyPrice"></td>
                            <td data-bind="currentPrice" class="currentPrice"></td>
                            <td data-bind="dayChange" class="dayChange">
                                <span data-bind="dayChangeRate" class="dayChangeRate"></span><span
                                    data-bind="dayChangeRate" class="percent">%</span>
                            </td>
                            <td data-bind="profitAndLoss" class="profitAndLoss">
                                <span data-bind="profitAndLossDiff" class="profitAndLossDiff"></span>
                            </td>
                            <td data-bind="marketCap" class="marketCap"></td>
                        </tr>
                    </tbody>
                    <!-- テーブルフッター -->
                    <tfoot>
                        <tr class="totalRow">
                            <td colspan="6">合計</td>
                            <td class="profit" data-bind="totalProfit">-</td>
                            <td class="amount" data-bind="totalMarketCap">-</td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>
    </div>
    <div class="flex">
        <!-- 取引履歴テーブルコンテナ（当日約定含む） -->
        <div id="jpyAccountTradingLogContainer">
            <h2>取引履歴</h2>
            <div class="table-wrapper">
                <table>
                    <!-- テーブルヘッダー -->
                    <thead>
                        <tr>
                            <th>日付</th>
                            <th>コード</th>
                            <th>銘柄名</th>
                            <th>取引</th>
                            <th>株数</th>
                            <th>価格</th>
                        </tr>
                    </thead>
                    <!-- テーブルボディ（データバインディング用） -->
                    <tbody>
                        <tr data-bind="jpyAccountTradingLogRow">
                            <td data-bind="date" class="date"></td>
                            <td data-bind="code" class="code"></td>
                            <td data-bind="name" class="name"></td>
                            <td data-bind="tradeType" class="tradeType"></td>
                            <td data-bind="quantity" class="quantity"></td>
                            <td data-bind="price" class="price"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <!-- 株価変化率と売買数テーブルコンテナ -->
        <div id="priceChangeTableContainer">
            <h2>株価変化率と売買数</h2>
            <div class="table-wrapper">
                <table id="priceChangeTable">
                    <!-- テーブルヘッダー -->
                    <thead>
                        <tr data-bind="priceChangeHeaderRow">
                            <th rowspan="2" class="code-header">コード</th>
                            <th rowspan="2" class="name-header">銘柄名</th>
                            <!-- 日付列ヘッダーのテンプレート（複製される） -->
                            <th colspan="2" data-bind="dateHeader" class="date-header"></th>
                        </tr>
                        <tr data-bind="priceChangeSubHeaderRow">
                            <!-- 変化率/売買数ヘッダーのテンプレート（複製される） -->
                            <th data-bind="ratioHeader">変化率</th>
                            <th data-bind="quantityHeader">売買数</th>
                        </tr>
                    </thead>
                    <!-- テーブルボディ -->
                    <tbody>
                        <tr data-bind="priceChangeTableRow">
                            <td data-bind="code" class="code"></td>
                            <td data-bind="name" class="name"></td>
                            <!-- データセルのテンプレート（複製される） -->
                            <td data-bind="ratio" class="changeRate"></td>
                            <td data-bind="quantity" class="quantity"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div id="calcToolsContainer">
        <h2>計算ツール</h2>
        <div id="leverageCalculator">
            <h3>レバレッジ簡易計算</h3>
            <div class="leverageCalcControls">
                <label class="leverageCalcControl" for="maxDrawdownSelect">
                    <span class="question">最大DDをどこまで許容するのか</span>
                    <select id="maxDrawdownSelect" data-leverage-select="maxDrawdown">
                        <option value="dd30">最大DD▲30％まで許容（ベース 0.55）</option>
                        <option value="dd50">最大DD▲50％まで許容（ベース 0.90）</option>
                        <option value="dd66">最大DD▲66％まで許容（ベース 1.20）</option>
                    </select>
                </label>
                <label class="leverageCalcControl" for="shockSelect">
                    <span class="question">最高値更新中にリーマン級ショックをケアするか</span>
                    <select id="shockSelect" data-leverage-select="shockCare">
                        <option value="care">ケアする（×1）</option>
                        <option value="ignore">ケアしない（×55/33）</option>
                    </select>
                </label>
                <label class="leverageCalcControl" for="stockTypeSelect">
                    <span class="question">保有している銘柄は指数・大型株・小型株のどれに近いか</span>
                    <select id="stockTypeSelect" data-leverage-select="stockType">
                        <option value="index">指数（×1）</option>
                        <option value="largeMultiple">大型株複数（×0.80）</option>
                        <option value="largeSingle">大型株単体（×0.66）</option>
                        <option value="smallMultiple">小型株複数（×0.50）</option>
                        <option value="smallSingle">小型株単体（×0.33）</option>
                    </select>
                </label>
                <label class="leverageCalcControl" for="drawdownLeverageSelect">
                    <span class="question">下落時レバレッジでどれくらいレバレッジをかけるか</span>
                    <select id="drawdownLeverageSelect" data-leverage-select="drawdown">
                        <option value="recentHigh">直近4年の最高値（×1）</option>
                        <option value="drop30">直近4年の最高値から30%下落（×1.5）</option>
                        <option value="drop60">直近4年の最高値から60%下落（×2.0）</option>
                    </select>
                </label>
            </div>
            <div class="leverageCalcResult">
                <div class="resultLabel">計算結果</div>
                <div class="resultValue" data-leverage-result>--</div>
                <div class="resultUnit">倍</div>
                <div class="resultDetail" data-leverage-detail>ベースレバレッジと各倍率を選択してください</div>
            </div>
        </div>
    </div>
</div>